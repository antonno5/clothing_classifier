# ClothingClassifier

Носачев Антон

### Постановка задачи

---

Задача - на основе
[датасета](https://www.kaggle.com/datasets/zalando-research/fashionmnist)
взятого с kaggle обучить модель предсказывать тип одежды. Модель будет
обучаться стандартная, задача - оформить всё надлежащим продовым образом.

### Формат входных и выходных данных

На вход подается черно-белое изображение одежды, выход - название предмета
одежды(поддерживается 10 различных предметов одежды).

### Метрики

Стадартные для задачи классификации: Accuracy и F1-score

### Данные

Данные берутся из указанного выше источника(хранятся локально, потому что негде
больше). Использовать будем только train датасет.

### Валидация

Датасет бьется на три части(трейн/тест/валидация) в отношении 70/15/15. Для
воспроизводимости берем `seed=42`.

## Моделирование

### Бейзлайн

Простое решение - линейная регрессия. Однако мы обучим более продвинутую
модель.

### Основная модель

Будем использовать ResNet как пример несложной свёрточной нейросети которая
вполне справится с данной задачей.

### Внедрение

Бизнесу проще всего будет пользоваться моделью через вебсервис, потому что в
таком случае можно будет довольно просто пользоваться моделью через ручку.

## Setup

Разработка проводилась на рабочем ноутбуке Macbook Air M3. Пакетменеджер -
poetry. Для установки необходимо сделать следующее(подразумевается, что python,
poetry и git уже установлены):

- `git pull git@github.com:antonno5/clothing_classifier.git`
- `poetry install --no-root`
- `eval $(poetry env activate)`

## Train

Для запуска тренировки нужно поднять mlflow сервер для просмотра логов:

`mlflow server --port 5000`

После этого можно запускать тренировку следующей командой:

`python3 clothing_classifier/commands.py train`

Все данные автоматически подгрузятся, если они ещё не скачаны(запускается
скрипт scripts/download_dataset)

Также автоматически будут составлены маппинги для лейблов(индекс - элемент
одежды) и (элемент одежды - индекс) которые также сохранятся в dvc.

Для тестирования нужно выполнить команду:

`python3 clothing_classifier/commands.py test --test_dir=<директория с моделями> --checkpoint_name=<имя файла чекпоинта в указанной ранее директории>`

При тестировании получились следующие метрики:

| Test metric   | DataLoader 0       |
| ------------- | ------------------ |
| test_accuracy | 0.5578888654708862 |
| test_fiscore  | 0.5384445190429688 |

---

### Ссылки на материалы

- Датасет:
  https://www.kaggle.com/datasets/zalando-research/fashionmnist?select=fashion-mnist_train.csv
- Модель: https://huggingface.co/microsoft/resnet-18
